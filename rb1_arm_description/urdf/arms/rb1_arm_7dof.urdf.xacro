<?xml version="1.0"?>
<robot name="rb1_arm_7dof" xmlns:xacro="http://www.ros.org/wiki/xacro"> 

  <xacro:include filename="$(find rb1_arm_description)/urdf/arms/rb1_arm_7dof.gazebo.xacro" />

  <xacro:include filename="$(find rb1_arm_description)/urdf/links/rb1_arm_link.urdf.xacro" />

  <xacro:property name="j1_mechanical_reduction" value="502.0"/>
  <xacro:property name="j1_motor_torque_constant" value="5.0"/>
  <xacro:property name="j2_mechanical_reduction" value="502.0"/>
  <xacro:property name="j2_motor_torque_constant" value="5.0"/>
  <xacro:property name="j3_mechanical_reduction" value="502.0"/>
  <xacro:property name="j3_motor_torque_constant" value="5.0"/>
  <xacro:property name="j4_mechanical_reduction" value="502.0"/>
  <xacro:property name="j4_motor_torque_constant" value="5.0"/>
  <xacro:property name="j5_mechanical_reduction" value="502.0"/>
  <xacro:property name="j5_motor_torque_constant" value="5.0"/>
  <xacro:property name="j6_mechanical_reduction" value="304.0"/>
  <xacro:property name="j6_motor_torque_constant" value="3.0"/>
  <xacro:property name="j7_mechanical_reduction" value="304.0"/>
  <xacro:property name="j7_motor_torque_constant" value="3.0"/>

  <xacro:property name="joint_effort_limit" value="100.0"/>
  <xacro:property name="joint_velocity_limit" value="3.0"/>
  <xacro:property name="joint_damping" value="0.5"/>
  <xacro:property name="joint_friction" value="0.5"/>


  <xacro:macro name="rb1_arm_7dof" params="name hq">

    <!-- Robot mechanical and motor parameters -->
    <xacro:property name="PI" value="3.1415926535897931"/>
    <xacro:property name="gearbox" value="500.0" />

    <!-- BASE_LINK -->
    <link
      name="base_link_rb1_arm">
    </link>

    <xacro:arm_link name="arm_link1" hq="${hq}" parent="" num="01"/>
    <xacro:arm_link name="arm_link2" hq="${hq}" parent="" num="12"/>
    <xacro:arm_link name="arm_link3" hq="${hq}" parent="" num="23"/>
    <xacro:arm_link name="arm_link4" hq="${hq}" parent="" num="34"/>
    <xacro:arm_link name="arm_link5" hq="${hq}" parent="" num="45"/>
    <xacro:arm_link name="arm_link6" hq="${hq}" parent="" num="56"/>
    <xacro:arm_link name="arm_link7" hq="${hq}" parent="" num="67"/>
		
	<joint
	  name="j1_rb1_arm"
      type="fixed">
    <origin
      xyz="0.0 0.0 0.0"
      rpy="0.0 0.0 0.0" />
    <parent
      link="base_link_rb1_arm" />
    <child
      link="link1_rb1_arm" />
    <axis
      xyz="0 0 0" />
	</joint>

	<joint
		name="j1"
		type="revolute">
	  <origin
        xyz="0 0 0"
        rpy="0.0 0.0 0.0" />
	  <parent link="link1_rb1_arm" />	
      <child link="link12_rb1_arm" />
      <axis xyz="0 0 -1" />
      <limit effort="${joint_effort_limit}" velocity="${joint_velocity_limit}" upper="${PI/2}" lower="${-PI/2}"/>
      <dynamics damping="${joint_damping}" friction="${joint_friction}"/>
    </joint>
    
    <transmission name="j1_trans">
	 <type>transmission_interface/SimpleTransmission</type>
     <joint name="j1" />
     <actuator name="j1_motor">
	    <hardwareInterface>EffortJointInterface</hardwareInterface>
        <mechanicalReduction>${j1_mechanical_reduction}</mechanicalReduction>
		<motorTorqueConstant>${j1_motor_torque_constant}</motorTorqueConstant>
	 </actuator>	 
    </transmission>

	<joint
		name="j2"
		type="revolute">
	  <origin
        xyz="0.135 0 0"
        rpy="${PI/2} 0.0 0.0" />
	  <parent link="link12_rb1_arm" />	
      <child link="link23_rb1_arm" />
      <axis xyz="0 0 -1" />
      <limit effort="${joint_effort_limit}" velocity="${joint_velocity_limit}" upper="${PI/2}" lower="${-PI/2}"/>
      <dynamics damping="${joint_damping}" friction="${joint_friction}"/>
    </joint>
    
    <transmission name="j2_trans">
	 <type>transmission_interface/SimpleTransmission</type>
     <joint name="j2" />
     <actuator name="j2_motor">
	    <hardwareInterface>EffortJointInterface</hardwareInterface>
        <mechanicalReduction>${j2_mechanical_reduction}</mechanicalReduction>
		<motorTorqueConstant>${j2_motor_torque_constant}</motorTorqueConstant>
	 </actuator>	 
    </transmission>

	<joint
		name="j3"
		type="revolute">
	  <origin
        xyz="0.310 0 0"
        rpy="0.0 0.0 0.0" />
	  <parent link="link23_rb1_arm" />	
      <child link="link34_rb1_arm" />
      <axis xyz="1 0 0" />
      <limit effort="${joint_effort_limit}" velocity="${joint_velocity_limit}" upper="${PI/2}" lower="${-PI/2}"/>
      <dynamics damping="${joint_damping}" friction="${joint_friction}"/>
    </joint>
    
    <transmission name="j3_trans">
	 <type>transmission_interface/SimpleTransmission</type>
     <joint name="j3" />
     <actuator name="j3_motor">
	    <hardwareInterface>EffortJointInterface</hardwareInterface>
        <mechanicalReduction>${j3_mechanical_reduction}</mechanicalReduction>
		<motorTorqueConstant>${j3_motor_torque_constant}</motorTorqueConstant>
	 </actuator>	 
    </transmission>

	<joint
		name="j4"
		type="revolute">
	  <origin
        xyz="0 0 0"
        rpy="0.0 0.0 0.0" />
	  <parent link="link34_rb1_arm" />	
      <child link="link45_rb1_arm" />
      <axis xyz="0 0 -1" />
      <limit effort="${joint_effort_limit}" velocity="${joint_velocity_limit}" upper="${PI/2}" lower="${-PI/2}"/>
      <dynamics damping="${joint_damping}" friction="${joint_friction}"/>
    </joint>
    
    <transmission name="j4_trans">
	 <type>transmission_interface/SimpleTransmission</type>
     <joint name="j4" />
     <actuator name="j4_motor">
	    <hardwareInterface>EffortJointInterface</hardwareInterface>
        <mechanicalReduction>${j4_mechanical_reduction}</mechanicalReduction>
		<motorTorqueConstant>${j4_motor_torque_constant}</motorTorqueConstant>
	 </actuator>	 
    </transmission>

	<joint
		name="j5"
		type="revolute">
	  <origin
        xyz="0.285 0 0"
        rpy="0.0 0.0 0.0" />
	  <parent link="link45_rb1_arm" />	
      <child link="link56_rb1_arm" />
      <axis xyz="1 0 0" />
      <limit effort="${joint_effort_limit}" velocity="${joint_velocity_limit}" upper="${PI/2}" lower="${-PI/2}"/>
      <dynamics damping="${joint_damping}" friction="${joint_friction}"/>
    </joint>
    
    <transmission name="j5_trans">
	 <type>transmission_interface/SimpleTransmission</type>
     <joint name="j5" />
     <actuator name="j5_motor">
	    <hardwareInterface>EffortJointInterface</hardwareInterface>
        <mechanicalReduction>${j5_mechanical_reduction}</mechanicalReduction>
		<motorTorqueConstant>${j5_motor_torque_constant}</motorTorqueConstant>
	 </actuator>	 
    </transmission>

	<joint
		name="j6"
		type="revolute">
	  <origin
        xyz="0 0 0"
        rpy="0.0 0.0 0.0" />
	  <parent link="link56_rb1_arm" />	
      <child link="link67_rb1_arm" />
      <axis xyz="0 0 -1" />
      <limit effort="${joint_effort_limit}" velocity="${joint_velocity_limit}" upper="${PI/2}" lower="${-PI/2}"/>
      <dynamics damping="${joint_damping}" friction="${joint_friction}"/>
    </joint>
    
    <transmission name="j6_trans">
	 <type>transmission_interface/SimpleTransmission</type>
     <joint name="j6" />
     <actuator name="j6_motor">
	    <hardwareInterface>EffortJointInterface</hardwareInterface>
        <mechanicalReduction>${j6_mechanical_reduction}</mechanicalReduction>
		<motorTorqueConstant>${j6_motor_torque_constant}</motorTorqueConstant>
	 </actuator>	 
    </transmission>
    
    <link
      name="end_effector_rb1_arm">
    </link>
    
	<joint
		name="j7"
		type="revolute">
	  <origin
        xyz="0 0 0"
        rpy="0.0 0.0 0.0" />
	  <parent link="link67_rb1_arm" />	
      <child link="end_effector_rb1_arm" />
      <axis xyz="0 0 -1" />
      <limit effort="${joint_effort_limit}" velocity="${joint_velocity_limit}" upper="${PI/2}" lower="${-PI/2}"/>
      <dynamics damping="${joint_damping}" friction="${joint_friction}"/>
    </joint>
    
    <transmission name="j7_trans">
	 <type>transmission_interface/SimpleTransmission</type>
     <joint name="j7" />
     <actuator name="j7_motor">
	    <hardwareInterface>EffortJointInterface</hardwareInterface>
        <mechanicalReduction>${j7_mechanical_reduction}</mechanicalReduction>
		<motorTorqueConstant>${j7_motor_torque_constant}</motorTorqueConstant>
	 </actuator>	 
    </transmission>
    

  </xacro:macro>
</robot>


